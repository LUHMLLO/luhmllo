---
import { Image } from 'astro:assets';
import Logo from '../assets/logo.png';
import IconGithub from '../assets/icon_github.svg';
import IconJSR from '../assets/icon_jsr.svg';
import IconSponsor from '../assets/icon_sponsor.svg';
---

<aside id='app__sidebar' data-visible='true'>
	<div data-is='flex'>
		<a href='/' data-variant='text'>
			<figure>
				<Image src={Logo} alt='logo' decoding='async' loading='eager' />
			</figure>

			<div>
				<h5>Lilycat</h5>
				<p>DX-Oriented CSS library.</p>
			</div>
		</a>

		<button data-toggle-sidebar>
			<i data-is='icon'> left_panel_close </i>
		</button>
	</div>

	<label for='search' data-is='input'>
		<i data-is='icon' data-part='lead'> search </i>
		<input type='text' name='search' id='search' />
		<kbd data-part='trail'>Ctrl + K</kbd>
	</label>

	<hr />

	<ul role='list'>
		<p>Get Started</p>
		<li>
			<a href={'#' + crypto.randomUUID()} data-variant='text'>
				<span>Introduction</span>
			</a>
		</li>
		<li>
			<details>
				<summary>
					<span>Quickstart</span>
					<i data-is='icon' data-part='trail'> keyboard_arrow_down </i>
				</summary>
				<ul>
					<li>
						<a href={'#' + crypto.randomUUID()} data-variant='text'>
							<span>How to install</span>
						</a>
					</li>
					<li>
						<a href={'#' + crypto.randomUUID()} data-variant='text'>
							<span>How to use</span>
						</a>
					</li>
					<li>
						<a href={'#' + crypto.randomUUID()} data-variant='text'>
							<span>Tailwind support</span>
						</a>
					</li>
				</ul>
			</details>
		</li>
		<li>
			<a href={'#' + crypto.randomUUID()} data-variant='text'>
				<span>Examples</span>
			</a>
		</li>
		<li>
			<a href={'#' + crypto.randomUUID()} data-variant='text'>
				<span>FAQs</span>
			</a>
		</li>
	</ul>

	<ul role='list'>
		<p>Concepts</p>
		<li>
			<a href={'#' + crypto.randomUUID()} data-variant='text'>
				<span>Philosophy</span>
			</a>
		</li>
		<li>
			<details>
				<summary>
					<span>Symbols</span>
					<i data-is='icon' data-part='trail'> keyboard_arrow_down </i>
				</summary>
				<ol>
					<li class='active'>
						<a href={'#' + crypto.randomUUID()} data-variant='text'>
							<span>Tokens</span>
						</a>
					</li>
					<li>
						<a href={'#' + crypto.randomUUID()} data-variant='text'>
							<span>Reset</span>
						</a>
					</li>
					<li>
						<a href={'#' + crypto.randomUUID()} data-variant='text'>
							<span>Normalize</span>
						</a>
					</li>
					<li>
						<a href={'#' + crypto.randomUUID()} data-variant='text'>
							<span>Icons</span>
						</a>
					</li>
					<li>
						<a href={'#' + crypto.randomUUID()} data-variant='text'>
							<span>Customs</span>
						</a>
					</li>
					<li>
						<a href={'#' + crypto.randomUUID()} data-variant='text'>
							<span>Props</span>
						</a>
					</li>
				</ol>
			</details>
		</li>
	</ul>

	<ul role='list'>
		<p>Development</p>
		<li>
			<a href={'#' + crypto.randomUUID()} data-variant='text'>
				<span>What's new</span>
			</a>
		</li>
		<li>
			<a href={'#' + crypto.randomUUID()} data-variant='text'>
				<span>Roadmap</span>
			</a>
		</li>
		<li>
			<a href={'#' + crypto.randomUUID()} data-variant='text'>
				<span>Contributing</span>
			</a>
		</li>
	</ul>

	<hr />

	<ul role='list'>
		<li>
			<a
				href='https://github.com/LUHMLLO/lilycat'
				target='_blank'
				data-variant='text'
				style='width: 100%;'>
				<figure
					style='aspect-ratio: 1/1; display: inline-flex; height: calc(20 * 0.0625rem); place-content: center;'>
					<IconGithub />
				</figure>
				<span>GitHub Repository</span>
				<i data-is='icon' data-part='trail'>arrow_outward</i>
			</a>
		</li>
		<li>
			<a
				href='https://jsr.io/@luhmllo/lilycat'
				target='_blank'
				data-variant='text'
				style='width: 100%;'>
				<figure
					style='aspect-ratio: 1/1; display: inline-flex; height: calc(20 * 0.0625rem); place-content: center;'>
					<IconJSR />
				</figure>
				<span>JSR Package</span>
				<i data-is='icon' data-part='trail'>arrow_outward</i>
			</a>
		</li>
		<li>
			<a
				href='https://github.com/sponsors/LUHMLLO'
				target='_blank'
				data-variant='text'
				style='width: 100%;'>
				<figure
					style='aspect-ratio: 1/1; display: inline-flex; height: calc(20 * 0.0625rem); place-content: center;'>
					<IconSponsor />
				</figure>
				<span>Support Us</span>
				<i data-is='icon' data-part='trail'>arrow_outward</i>
			</a>
		</li>
	</ul>

	<script type='module' is:inline>
		window.addEventListener('DOMContentLoaded', () => {
			const sidebar = document.querySelector('#app__sidebar');
			if (!sidebar) return;

			// Read from localStorage on load
			const isVisible = localStorage.getItem('sidebarVisible') !== 'false';
			sidebar.dataset.visible = isVisible;

			const setVisibility = (visible) => {
				sidebar.dataset.visible = visible;
				localStorage.setItem('sidebarVisible', visible ? 'true' : 'false');

				// Emit visibility change
				dispatchEvent(
					new CustomEvent('sidebar:visibility', {
						detail: { visible },
					})
				);
			};

			document.querySelectorAll('[data-toggle-sidebar]').forEach((el) =>
				el.addEventListener('click', () => {
					const nowVisible = sidebar.dataset.visible !== 'true';
					setVisibility(nowVisible);
				})
			);
		});
	</script>

	<style lang='css' is:inline>
		@scope {
			:scope {
				background-color: var(--clr-background__base);
				border-right: solid 2px var(--clr-border__base);
				gap: var(--xl);
				grid-column: left;
				grid-row: expand;
				height: 100dvh;
				inset: 0;
				overflow: auto;
				padding: var(--xl) var(--sm);
				position: sticky;
				scrollbar-gutter: both-edges stable;
				transition-property: opacity, position, transform, translate;
				transition-duration: var(--animDuration);
				transition-timing-function: var(--animTiming);
				width: max(0, calc(300 * 0.0625rem));
				z-index: 5;

				&[data-visible='false'] {
					opacity: 0;
					position: fixed;
					transform: translateX(-100%);
				}

				& > [data-is='flex'] {
					gap: var(--xs);

					a {
						flex: 1 1 auto;
						flex-wrap: wrap;

						& > figure {
							aspect-ratio: 1/1;
							flex-shrink: 0;
							vertical-align: middle;
							width: calc(45 * 0.0625rem);
						}

						& > div {
							flex: 1 1 auto;
							min-width: 0;
						}
					}
				}
			}
		}
	</style>
</aside>
