---
import Layout from './.lib/layout.astro';
import PreviewCard from './.lib/components/previewCard.astro';

const cards = [
	'https://images.unsplash.com/photo-1749735531899-aea6fba596e0?q=80&w=384&auto=format&fit=crop&ixlib=rb-4.1.0&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D',
	'https://images.unsplash.com/photo-1722904218663-f8b880a6823e?q=80&w=384&auto=format&fit=crop&ixlib=rb-4.1.0&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D',
	'https://images.unsplash.com/photo-1743805350606-56ed5103769c?q=80&w=384&auto=format&fit=crop&ixlib=rb-4.1.0&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D',
	'https://images.unsplash.com/photo-1748069036834-41a799145294?q=80&w=384&auto=format&fit=crop&ixlib=rb-4.1.0&ixid=M3xxxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D',
	'https://images.unsplash.com/photo-1749448621505-ed86401fec28?q=80&w=384&auto=format&fit=crop&ixlib=rb-4.1.0&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D',
	'https://images.unsplash.com/photo-1749301560225-3032826b9e7f?q=80&w=384&auto=format&fit=crop&ixlib=rb-4.1.0&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D',
	'https://images.unsplash.com/photo-1749259560252-ca132892004f?q=80&w=384&auto=format&fit=crop&ixlib=rb-4.1.0&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D',
];
---

<Layout>
	<div data-is='cardstack'>
		{
			cards.map((image, i) => (
				<PreviewCard
					{image}
					style={`--target-delay: ${i * 0.15}s; --target-opacity: ${Math.max(1 - i / cards.length, 0.1)}; --target-rotation: ${i * 5}deg; filter: blur(${i * 0.125}ex); z-index: ${i * -1}`}
				/>
			))
		}

		<style lang='css' is:inline>
			@scope ([data-is="cardstack"]) {
				@keyframes slide-in {
					from {
						transform: translateY(100%);
					}
					to {
						transform: translateY(0);
					}
				}

				@keyframes rotate-in {
					from {
						opacity: 0;
						transform: rotate(0deg);
					}
					to {
						opacity: var(--target-opacity);
						transform: rotate(var(--target-rotation));
					}
				}

				:scope {
					animation-delay: var(--animDuration);
					animation-duration: var(--animDuration);
					animation-name: slide-in;
					animation-timing-function: var(--animTiming);
					animation-fill-mode: forwards;

					height: max-content;
					inset: 0;
					margin: auto;
					position: absolute;
					display: inline-grid;
					place-items: center;
					transform: translateY(100%);
					width: max-content;

					& > * {
						animation-delay: calc(var(--animDuration) + var(--target-delay));
						animation-duration: var(--animDuration);
						animation-name: rotate-in;
						animation-timing-function: var(--animTiming);
						animation-fill-mode: forwards;

						grid-area: 1 / 1;
						opacity: 0;
						transform: rotate(0deg);

						&:not(:nth-child(1)) {
							pointer-events: none;
						}
					}
				}
			}
		</style>
	</div>
</Layout>
