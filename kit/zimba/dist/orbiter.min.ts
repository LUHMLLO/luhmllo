// deno-lint-ignore-file
// @ts-nocheck - Generated code
var b=Object.defineProperty;var r=(u,t)=>b(u,"name",{value:t,configurable:!0});var m=class{static{r(this,"Orbiter")}orbiterElement;boundaryElement;options;state;rafId=null;resizeObserver=null;handleMouseMove;handleMouseLeave;handleTouchMove;handleTouchEnd;isDestroyed=!1;isInitialized=!1;constructor(t,e,s={}){this.orbiterElement=t,this.boundaryElement=e,this.options=this._applyDefaults(s),this.state={current:{x:0,y:0},target:{x:0,y:0},constraints:{maxX:0,maxY:0,centerX:0,centerY:0},isAnimating:!1,isTracking:!1,animationId:null,lastUpdateTime:0},this.handleMouseMove=this._handleMouseMove.bind(this),this.handleMouseLeave=this._handleMouseLeave.bind(this),this.handleTouchMove=this._handleTouchMove.bind(this),this.handleTouchEnd=this._handleTouchEnd.bind(this),this._validateConfiguration(),this._calculateConstraints(),this._attachEventListeners(),this._setupResizeObserver(),this._updateTransform(),this.isInitialized=!0}_applyDefaults(t){return{factor:t.factor??1,smoothing:{enabled:t.smoothing?.enabled??!0,speed:t.smoothing?.speed??.1},touch:{enabled:t.touch?.enabled??!0,useFirstTouch:t.touch?.useFirstTouch??!0},constraintMode:t.constraintMode??"clamp",elastic:{tension:t.elastic?.tension??625e-6,snapBackDuration:t.elastic?.snapBackDuration??256},onLeave:t.onLeave??"reset",resetAnimation:{duration:t.resetAnimation?.duration??256,easing:t.resetAnimation?.easing??"easeInOut"}}}_validateConfiguration(){if(!this.orbiterElement||!this.boundaryElement)throw new Error("Orbiter requires valid orbiter and boundary elements");if(this.options.smoothing.speed<0||this.options.smoothing.speed>1)throw new Error("Smoothing speed must be between 0 and 1");if(this.options.elastic.tension<0||this.options.elastic.tension>1)throw new Error("Elastic tension must be between 0 and 1")}_calculateConstraints(){if(this.isDestroyed)return;let t=this.boundaryElement.getBoundingClientRect(),e=this.orbiterElement.getBoundingClientRect(),s={maxX:Math.max(0,(t.width-e.width)/2),maxY:Math.max(0,(t.height-e.height)/2),centerX:t.width/2,centerY:t.height/2};(Math.abs(this.state.constraints.maxX-s.maxX)>1||Math.abs(this.state.constraints.maxY-s.maxY)>1||Math.abs(this.state.constraints.centerX-s.centerX)>1||Math.abs(this.state.constraints.centerY-s.centerY)>1)&&(this.state.constraints=s)}_attachEventListeners(){this.isDestroyed||(this.boundaryElement.addEventListener("mousemove",this.handleMouseMove,{passive:!0}),this.boundaryElement.addEventListener("mouseleave",this.handleMouseLeave,{passive:!0}),this.options.touch.enabled&&(this.boundaryElement.addEventListener("touchmove",this.handleTouchMove,{passive:!0}),this.boundaryElement.addEventListener("touchend",this.handleTouchEnd,{passive:!0}),this.boundaryElement.addEventListener("touchcancel",this.handleTouchEnd,{passive:!0})))}_removeEventListeners(){this.boundaryElement.removeEventListener("mousemove",this.handleMouseMove),this.boundaryElement.removeEventListener("mouseleave",this.handleMouseLeave),this.options.touch.enabled&&(this.boundaryElement.removeEventListener("touchmove",this.handleTouchMove),this.boundaryElement.removeEventListener("touchend",this.handleTouchEnd),this.boundaryElement.removeEventListener("touchcancel",this.handleTouchEnd))}_setupResizeObserver(){if(!globalThis.ResizeObserver||this.isDestroyed)return;let t;this.resizeObserver=new ResizeObserver(()=>{t&&clearTimeout(t),t=setTimeout(()=>{this.isDestroyed||this._calculateConstraints(),t=void 0},16)}),this.resizeObserver.observe(this.boundaryElement),this.resizeObserver.observe(this.orbiterElement)}_calculateTargetPosition(t,e){let s=this.boundaryElement.getBoundingClientRect(),i=t-s.left,n=e-s.top,o=(i-this.state.constraints.centerX)*this.options.factor,h=(n-this.state.constraints.centerY)*this.options.factor;return this._applyConstraints(o,h)}_applyConstraints(t,e){let{maxX:s,maxY:i}=this.state.constraints;switch(this.options.constraintMode){case"clamp":return{x:Math.max(-s,Math.min(t,s)),y:Math.max(-i,Math.min(e,i))};case"elastic":{let n=this.options.elastic.tension;return{x:t>s?s+(t-s)*n:t<-s?-s+(t+s)*n:t,y:e>i?i+(e-i)*n:e<-i?-i+(e+i)*n:e}}case"none":default:return{x:t,y:e}}}_updateTransform(){this.isDestroyed||(this.rafId&&cancelAnimationFrame(this.rafId),this.rafId=requestAnimationFrame(()=>{if(this.isDestroyed)return;let{x:t,y:e}=this.state.current;this.orbiterElement.style.setProperty("--translate-x",`${t}px`),this.orbiterElement.style.setProperty("--translate-y",`${e}px`),this.orbiterElement.style.setProperty("--translate-z","0px"),this.rafId=null}))}_startAnimationLoop(){if(this.state.animationId||this.isDestroyed)return;let t=r(e=>{if(!this.state.isAnimating||this.isDestroyed){this.state.animationId=null;return}if(this.state.lastUpdateTime=e,this.options.smoothing.enabled){let s=this.options.smoothing.speed,i=this.state.target.x-this.state.current.x,n=this.state.target.y-this.state.current.y;this.state.current.x+=i*s,this.state.current.y+=n*s,i*i+n*n<.01&&!this.state.isTracking&&(this.state.current.x=this.state.target.x,this.state.current.y=this.state.target.y,this.state.isAnimating=!1)}else this.state.current.x=this.state.target.x,this.state.current.y=this.state.target.y,this.state.isTracking||(this.state.isAnimating=!1);this._updateTransform(),this.state.isAnimating&&!this.isDestroyed?this.state.animationId=requestAnimationFrame(t):this.state.animationId=null},"animate");this.state.isAnimating=!0,this.state.lastUpdateTime=performance.now(),this.state.animationId=requestAnimationFrame(t)}_stopAnimationLoop(){this.state.isAnimating=!1,this.state.animationId&&(cancelAnimationFrame(this.state.animationId),this.state.animationId=null)}_animateToCenter(){if(this.isDestroyed)return;this._stopAnimationLoop();let t=performance.now(),e=this.state.current.x,s=this.state.current.y,{duration:i,easing:n}=this.options.resetAnimation,o=r(a=>{switch(n){case"easeOut":return 1-Math.pow(1-a,3);case"easeInOut":return a<.5?2*a*a:1-Math.pow(-2*a+2,3)/2;case"linear":return a;default:return 1-Math.pow(1-a,2)}},"getEasingValue"),h,c=r(a=>{if(this.isDestroyed)return;let v=a-t,l=Math.min(v/i,1),d=o(l);this.state.current.x=e*(1-d),this.state.current.y=s*(1-d),this.state.target.x=this.state.current.x,this.state.target.y=this.state.current.y,this._updateTransform(),l<1&&!this.isDestroyed?h=requestAnimationFrame(c):this.state.isAnimating=!1},"animate");this.state.isAnimating=!0,h=requestAnimationFrame(c)}_handleMouseMove(t){this.isDestroyed||(this.state.isTracking=!0,this.state.target=this._calculateTargetPosition(t.clientX,t.clientY),this._startAnimationLoop())}_handleMouseLeave(){if(!this.isDestroyed)switch(this.state.isTracking=!1,this.options.onLeave){case"reset":this._animateToCenter();break;case"freeze":this._stopAnimationLoop();break;case"continue":this.options.smoothing.enabled||this._stopAnimationLoop();break}}_handleTouchMove(t){if(this.isDestroyed||!this.options.touch.enabled||t.touches.length===0)return;let e=this.options.touch.useFirstTouch?t.touches[0]:t.touches[t.touches.length-1];this.state.isTracking=!0,this.state.target=this._calculateTargetPosition(e.clientX,e.clientY),this._startAnimationLoop()}_handleTouchEnd(){this.isDestroyed||this._handleMouseLeave()}configure(t){if(this.isDestroyed)return;let e=this.options.touch.enabled;Object.assign(this.options,t),e!==this.options.touch.enabled&&(this._removeEventListeners(),this._attachEventListeners()),this._calculateConstraints()}getPosition(){return{...this.state.current}}setPosition(t,e){this.isDestroyed||(this.state.current.x=t,this.state.current.y=e,this.state.target.x=t,this.state.target.y=e,this._updateTransform())}reset(){this.isDestroyed||this._animateToCenter()}pause(){this.isDestroyed||(this.state.isTracking=!1,this._stopAnimationLoop())}resume(){this.isDestroyed}destroy(){this.isDestroyed||(this._stopAnimationLoop(),this.rafId&&(cancelAnimationFrame(this.rafId),this.rafId=null),this._removeEventListeners(),this.resizeObserver&&(this.resizeObserver.disconnect(),this.resizeObserver=null),this.state.animationId=null,this.state.isAnimating=!1,this.state.isTracking=!1,this.isDestroyed=!0)}};export{m as Orbiter};
